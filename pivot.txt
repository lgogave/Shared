[HttpPost]
public IActionResult DownloadExcelFile()
{
    try
    {
        using (var package = new ExcelPackage())
        {
            var worksheet = package.Workbook.Worksheets.Add("SampleSheet");
            worksheet.Cells[1, 1].Value = "Sample Data";

            var stream = new MemoryStream();
            package.SaveAs(stream);
            stream.Position = 0;

            Response.Headers.Add("Content-Disposition", "attachment; filename=SampleExcelFile.xlsx");
            Response.Headers.Add("Content-Type", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");

            return File(stream, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "SampleExcelFile.xlsx");
        }
    }
    catch (Exception ex)
    {
        // Log the exception (use your preferred logging method)
        Console.WriteLine($"Error generating Excel file: {ex.Message}");

        // Optionally return a status code with a message
        return StatusCode(500, "An error occurred while generating the Excel file.");
    }
}
